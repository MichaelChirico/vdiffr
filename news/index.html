<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Changelog • vdiffr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Changelog" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-news">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vdiffr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/01/vdiffr-0-3-0/">Version 0.3.0</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-lib/vdiffr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
      <h1 data-toc-skip>Changelog <small></small></h1>
      <small>Source: <a href='https://github.com/r-lib/vdiffr/blob/master/NEWS.md'><code>NEWS.md</code></a></small>
    </div>

    <div id="vdiffr-0-3-1-9000" class="section level1">
<h1 class="page-header" data-toc-text="0.3.1.9000">
<a href="#vdiffr-0-3-1-9000" class="anchor"></a>vdiffr 0.3.1.9000<small> Unreleased </small>
</h1>
<ul>
<li>Keyboard short cuts for common interactions: Right/Left arrows = Next/Previous case Down/Up arrows = Next/Previous type ENTER = Validate active case shift + ENTER = Validate active group ESC = Quit app</li>
</ul>
</div>
    <div id="vdiffr-0-3-1" class="section level1">
<h1 class="page-header" data-toc-text="0.3.1">
<a href="#vdiffr-0-3-1" class="anchor"></a>vdiffr 0.3.1<small> 2019-06-24 </small>
</h1>
<p>This release makes vdiffr compatible with ggplot2 3.2.0. It also features two contributions from the Tidyverse developer day in Austin:</p>
<ul>
<li><p>You can now select the validated cases in the Shiny app (<a href='https://github.com/r-lib/vdiffr/issues/38'>#38</a>, <a href='https://github.com/nathancday'>@nathancday</a>).</p></li>
<li><p>The testthat context is now shown on the Shiny app (<a href='https://github.com/r-lib/vdiffr/issues/14'>#14</a>, <a href='https://github.com/paleolimbot'>@paleolimbot</a>).</p></li>
</ul>
<p>Finally, it fixes warnings in non-UTF-8 MBCS locale (<a href='https://github.com/r-lib/vdiffr/issues/59'>#59</a>, <a href='https://github.com/yutannihilation'>@yutannihilation</a>).</p>
</div>
    <div id="vdiffr-0-3-0" class="section level1">
<h1 class="page-header" data-toc-text="0.3.0">
<a href="#vdiffr-0-3-0" class="anchor"></a>vdiffr 0.3.0<small> 2019-01-02 </small>
</h1>
<p>This release of vdiffr features a major overhaul of the internals to make the package more robust.</p>
<div id="cross-platform-reliability" class="section level2">
<h2 class="hasAnchor">
<a href="#cross-platform-reliability" class="anchor"></a>Cross-platform reliability</h2>
<p>vdiffr now works reliably across platforms:</p>
<ul>
<li><p>svglite is now embedded in vdiffr to protect against updates of the SVG generation engine.</p></li>
<li><p>It also embeds harfbuzz to compute font extents and text boxes metrics. This makes SVG generation of text boxes consisent across platforms.</p></li>
</ul>
<p>While this makes vdiffr much more robust, it also means you will have to regenerate all your testcases with the new version of vdiffr. You can expect very few future releases that will require updating figures, hopefully once every few years.</p>
<p>Now that vdiffr has a stable engine, the next release will focus on improving the Shiny UI.</p>
</div>
<div id="regression-testing-versus-unit-testing" class="section level2">
<h2 class="hasAnchor">
<a href="#regression-testing-versus-unit-testing" class="anchor"></a>Regression testing versus Unit testing</h2>
<p>Another important change is that figure mismatches are no longer reported as failures, except when the tests are run locally, on Travis, Appveyor, or any environment where the <code><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv("CI")</a></code> or <code><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv("NOT_CRAN")</a></code> variables are set. Because vdiffr is more of a monitoring than a unit testing tool, it shouldn’t cause R CMD check failures on the CRAN machines.</p>
<p>Despite our efforts to make vdiffr robust and reliable across platforms, checking the appearance of a figure is still inherently fragile. It is similar to testing for errors by matching exact error messages: these messages are susceptible to change at any time. Similarly, the appearance of plots depends on a lot of upstream code, such as the way margins and spacing are computed. vdiffr uses a special ggplot2 theme that should change very rarely, but there are just too many upstream factors that could cause breakages. For this reason, figure mismatches are not necessarily representative of actual failures.</p>
<p>Visual testing is not an alternative to writing unit tests for the internal data transformations performed during the creation of your figure. It is more of a monitoring tool that allows you to quickly check how the appearance of your figures changes over time, and to manually assess whether changes reflect actual problems in your package.</p>
<p>If you need to override the default vdiffr behaviour on CRAN (not recommended) or Travis (for example to run the tests in a particular builds but not others), set the <code>VDIFFR_RUN_TESTS</code> environment variable to “true” or “false”.</p>
</div>
<div id="features" class="section level2">
<h2 class="hasAnchor">
<a href="#features" class="anchor"></a>Features</h2>
<ul>
<li><p>vdiffr now advises user to run <code><a href="../reference/manage_cases.html">manage_cases()</a></code> when a figure was not validated yet (<a href='https://github.com/r-lib/vdiffr/issues/25'>#25</a>).</p></li>
<li><p>Fixed a bug in the Shiny app that prevented SVGs from being displayed in Firefox (<a href='https://github.com/KZARCA'>@KZARCA</a>, <a href='https://github.com/r-lib/vdiffr/issues/29'>#29</a>).</p></li>
<li><p><code><a href="../reference/manage_cases.html">manage_cases()</a></code> gains an <code>options</code> argument that is passed to <code><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shiny::shinyApp()</a></code> (<a href='https://github.com/KZARCA'>@KZARCA</a>).</p></li>
<li><p>The Shiny app now has a quit button (<a href='https://github.com/ilarischeinin'>@ilarischeinin</a>).</p></li>
<li><p>New <code>VDIFFR_LOG_PATH</code> environment variable. When set, vdiffr pushes diffs of failed SVG comparisons to that file.</p></li>
<li><p><code><a href="../reference/expect_doppelganger.html">expect_doppelganger()</a></code> now takes a <code>writer</code> argument. This makes it easy to use vdiffr with a different SVG engine. See <code><a href="../reference/write_svg.html">?write_svg</a></code> for an example function. Packages implementing a different SVG engine should wrap around <code><a href="../reference/expect_doppelganger.html">expect_doppelganger()</a></code> to pass their custom writer.</p></li>
<li><p><code><a href="../reference/write_svg.html">write_svg()</a></code> is now an exported function. It provides a template (function arguments and return value) for SVG writer functions.</p></li>
<li><p><code><a href="../reference/manage_cases.html">manage_cases()</a></code> no longer checks for orphaned cases when a filter is supplied. (Orphaned cases are figures dangling in the <code>figs</code> folder even though their original <code><a href="../reference/expect_doppelganger.html">expect_doppelganger()</a></code> has been removed from the tests.)</p></li>
</ul>
</div>
<div id="life-cycle" class="section level2">
<h2 class="hasAnchor">
<a href="#life-cycle" class="anchor"></a>Life cycle</h2>
<ul>
<li>
<p>The <code>verbose</code> argument of <code><a href="../reference/expect_doppelganger.html">expect_doppelganger()</a></code> is soft-deprecated. Please use the vdiffr failure log instead. It is created automatically when run under R CMD check in <code>tests/vdiffr.Rout.fail</code>, and should be displayed on Travis.</p>
<p>You can also set the <code>VDIFFR_LOG_PATH</code> environment variable with <code><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv()</a></code> to unconditionally (also interactively) log failures in the file pointed by the variable.</p>
</li>
<li><p><code><a href="../reference/add_dependency.html">add_dependency()</a></code> is soft-deprecated without replacement.</p></li>
<li><p>The <code>user_fonts</code> argument of <code><a href="../reference/expect_doppelganger.html">expect_doppelganger()</a></code> is defunct because it complicated the UI for no clear benefit. The fonts used to generate the SVGs are now hardcoded to Liberation and Symbola.</p></li>
</ul>
</div>
</div>
    <div id="vdiffr-0-2-3" class="section level1">
<h1 class="page-header" data-toc-text="0.2.3">
<a href="#vdiffr-0-2-3" class="anchor"></a>vdiffr 0.2.3<small> 2018-04-27 </small>
</h1>
<ul>
<li>Maintenance release to fix CRAN errors. Thanks to Gregory R. Warnes
<p>(<a href='https://github.com/gwarnes-mdsol'>@gwarnes-mdsol</a>) and Hiroaki Yutani (<a href='https://github.com/yutannihilation'>@yutannihilation</a>) for helping out with this!</p>
<p>I’m working on embedding svglite in vdiffr and compiling statically to FreeType and Harfbuzz to make SVG generation deterministic across platforms. Until then vdiffr will remain a bit unstable (but should silently fail if dependencies have diverged).</p>
</li>
<li><p>Use <code><a href="../reference/last_collection_error.html">last_collection_error()</a></code> to print a testthat error that occurred while collecting the test cases.</p></li>
</ul>
</div>
    <div id="vdiffr-0-2-2" class="section level1">
<h1 class="page-header" data-toc-text="0.2.2">
<a href="#vdiffr-0-2-2" class="anchor"></a>vdiffr 0.2.2<small> 2018-02-01 </small>
</h1>
<ul>
<li>
<p>Skip tests if the system version of Cairo (actually the one gdtools was compiled with) doesn’t match the version of Cairo used to generate the testcases. Cairo has an influence on the computation of text metrics which can cause spurious test failures.</p>
<p>We plan to fix these issues once and for all by embedding gdtools, svglite, Cairo and FreeType in the vdiffr package.</p>
</li>
</ul>
</div>
    <div id="vdiffr-0-2-1" class="section level1">
<h1 class="page-header" data-toc-text="0.2.1">
<a href="#vdiffr-0-2-1" class="anchor"></a>vdiffr 0.2.1<small> 2017-10-09 </small>
</h1>
<p>This release fixes some CRAN failures.</p>
<ul>
<li><p>Test cases of the mock package were updated to FreeType 2.8.0.</p></li>
<li><p>The unit test log file from the mock package is now preserved.</p></li>
</ul>
</div>
    <div id="vdiffr-0-2-0" class="section level1">
<h1 class="page-header" data-toc-text="0.2.0">
<a href="#vdiffr-0-2-0" class="anchor"></a>vdiffr 0.2.0<small> 2017-08-03 </small>
</h1>
<p>This release makes it easier to debug failures on remote systems. It also makes vdiffr more robust to failures caused by incompatible installations: instead of failing, the tests are skipped. This prevents spurious failures on CRAN.</p>
<div id="troubleshooting-on-remotes" class="section level2">
<h2 class="hasAnchor">
<a href="#troubleshooting-on-remotes" class="anchor"></a>Troubleshooting on remotes</h2>
<ul>
<li><p><code><a href="../reference/expect_doppelganger.html">expect_doppelganger()</a></code> gains a <code>verbose</code> argument to print the SVG files for failed cases while testing. This is useful to debug failures on remotes.</p></li>
<li><p>When tests are run by <code>R CMD check</code>, failures are now recorded in a log file called <code>vdiffr.fail</code>. This file will show up in the Travis log and can be retrieved from artifacts on Appveyor. It includes the SVG files for failed cases, which is useful to debug failures on remotes.</p></li>
</ul>
</div>
<div id="handling-of-incompatible-systems" class="section level2">
<h2 class="hasAnchor">
<a href="#handling-of-incompatible-systems" class="anchor"></a>Handling of incompatible systems</h2>
<p>The tests are now skipped if the FreeType version used to build the comparison SVGs does not match the version installed on the system where the tests are run. This is necessary because changes in new version of FreeType might affect the computation of text extents, which then causes svglite to produce slightly different SVGs. The minor version is not taken into account so FreeType 2.7.1 is deemed compatible with 2.7.2 but not with 2.8.0.</p>
<p>In practice, this means that package contributors should only validate visual cases if their FreeType version matches the one of the package maintainer. Also, the maintainer must update the version recorded in the package repository (in the file <code>./tests/figs/deps.txt</code>) when FreeType has been updated on their system. Running <code><a href="../reference/validate_cases.html">vdiffr::validate_cases()</a></code> updates the dependency file even if there are no visual case to update.</p>
<p>In the future, we may provide a version of vdiffr statically compiled with a specific version of FreeType to prevent these issues.</p>
</div>
<div id="other-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#other-changes" class="anchor"></a>Other changes</h2>
<ul>
<li>The minimal R version required by vdiffr is now R 3.1.0.</li>
</ul>
</div>
</div>
    <div id="vdiffr-0-1-1" class="section level1">
<h1 class="page-header" data-toc-text="0.1.1">
<a href="#vdiffr-0-1-1" class="anchor"></a>vdiffr 0.1.1<small> 2016-11-15 </small>
</h1>
<ul>
<li><p><code><a href="../reference/expect_doppelganger.html">expect_doppelganger()</a></code> no longer throws an error when FreeType is too old. Instead, the test is skipped. This ensures that R CMD check passes on those platforms (e.g., CRAN’s Solaris test server).</p></li>
<li><p>Depends on gdtools 0.1.2 or later as this version fixes a crash on Linux platforms.</p></li>
<li><p><code><a href="../reference/htmlwidgets.html">widget_toggle()</a></code>, <code><a href="../reference/htmlwidgets.html">widget_slide()</a></code> and <code><a href="../reference/htmlwidgets.html">widget_diff()</a></code> now take plots as arguments. This makes it easy to embed a vdiffr widget in R Markdown documents. The underscored versions take HTML sources as argument (paths to SVG files or inline SVGs).</p></li>
</ul>
</div>
    <div id="vdiffr-0-1-0" class="section level1">
<h1 class="page-header" data-toc-text="0.1.0">
<a href="#vdiffr-0-1-0" class="anchor"></a>vdiffr 0.1.0<small> 2016-11-08 </small>
</h1>
<ul>
<li><p>Generated SVGs are now reproducible across platforms thanks to recent versions of svglite, gdtools, and the new package fontquiver. vdiffr now requires versions of FreeType greater than 2.6.1.</p></li>
<li><p>The figures folder is hardcoded to <code>tests/figs/</code>.</p></li>
<li><p>The figures are now stored in subfolders according to the current testthat context. <code><a href="../reference/expect_doppelganger.html">expect_doppelganger()</a></code> accepts the <code>path</code> argument to bypass this behaviour (set it to <code>""</code> to store the figures in <code>tests/figs/</code>).</p></li>
<li><p>The <code>title</code> argument of <code><a href="../reference/expect_doppelganger.html">expect_doppelganger()</a></code> now serves as <code>ggtitle()</code> in ggplot2 figures (unless a title is already set). It is also standardised and used as filename to store the figure (spaces and non-alphanumeric characters are converted to dashes).</p></li>
<li><p>Add support for handling orphaned cases: you can now remove figures left over from deleted tests with <code><a href="../reference/validate_cases.html">delete_orphaned_cases()</a></code> or from the Shiny app.</p></li>
<li><p>New <code>filter</code> argument to <code><a href="../reference/collect_cases.html">collect_cases()</a></code> and <code><a href="../reference/manage_cases.html">manage_cases()</a></code>. This lets you filter the test files from which to collect the cases, which is useful to speed up the collection for large codebases with a lot of unit tests.</p></li>
<li><p>Fix invalid generation of SVG files (<a href='https://github.com/r-lib/vdiffr/issues/3'>#3</a>)</p></li>
<li><p>Give a warning when multiple doppelgangers have the same name (<a href='https://github.com/r-lib/vdiffr/issues/4'>#4</a>).</p></li>
<li><p>Remove CR line endings before comparing svg files for compatibility with Windows</p></li>
</ul>
</div>
    <div id="vdiffr-0-0-0-9000" class="section level1">
<h1 class="page-header" data-toc-text="0.0.0.9000">
<a href="#vdiffr-0-0-0-9000" class="anchor"></a>vdiffr 0.0.0.9000<small> Unreleased </small>
</h1>
<p>Initial release</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>

</div>


      <footer>
      <div class="copyright">
  <p>Developed by Lionel Henry, Carl Sutherland, David Hong, T Jake Luciani, Matthieu Decorde, Vaudor Lise.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


